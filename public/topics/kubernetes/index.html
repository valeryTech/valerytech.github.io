<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="http://localhost:1313/fonts/vendor/jost/jost-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/fonts/vendor/jost/jost-v4-latin-500.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/fonts/vendor/jost/jost-v4-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<script 
  src="/js/color-mode.f14b3e296de1d0b69e75af684b62a4a912a2cadab04e36123407cd8388204f1d.js"
  integrity="sha256-8Us&#43;KW3h0Laeda9oS2KkqRKiytqwTjYSNAfNg4ggTx0=">
</script>


<link rel="stylesheet" href="/main.1542a5884e04a94d737f95f75653bbae5d9d951aeefab7705a9db5f7a85e58fed8b1c2f686c1303120bb66c4ac2cbfbf1317d05cde7d463eccc899dbb8088787.css" integrity="sha512-FUKliE4EqU1zf5X3VlO7rl2dlRru&#43;rdwWp2196heWP7YscL2hsEwMSC7ZsSsLL&#43;/ExfQXN59Rj7MyJnbuAiHhw==" crossorigin="anonymous">

<noscript><style>img.lazyload { display: none; }</style></noscript><base href="http://localhost:1313/topics/kubernetes/">

  <link rel="canonical" href="http://localhost:1313/topics/kubernetes/">


<title>Kubernetes  |  System Design</title>
<meta name="description" content="Default Description">

    
    <link rel="icon" href="/favicon.ico" sizes="32x32">
    
      <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    
      <link
        rel="apple-touch-icon"
        href="/apple-touch-icon.png"
        sizes="180x180"
        type="image/png"
      >
      <link
        rel="icon"
        href="/favicon-192x192.png"
        sizes="192x192"
        type="image/png"
      >
      <link
        rel="icon"
        href="/favicon-512x512.png"
        sizes="512x512"
        type="image/png"
      >
<link rel="manifest" href="/manifest.webmanifest">

<meta property="og:url" content="http://localhost:1313/topics/kubernetes/">
  <meta property="og:site_name" content="System Design">
  <meta property="og:title" content="Kubernetes">
  <meta property="og:description" content="Default Description">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="topics">
    <meta property="article:published_time" content="2025-02-21T12:11:28+00:00">
    <meta property="article:modified_time" content="2025-02-21T12:11:28+00:00">
    <meta property="og:image" content="http://localhost:1313/cover.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/cover.png">
  <meta name="twitter:title" content="Kubernetes">
  <meta name="twitter:description" content="Default Description">
      <meta name="twitter:site" content="@tecvalery">

    
    <script type="application/ld+json">
  {
   "@context": "https://schema.org",
   "@type": "BreadcrumbList",
   "itemListElement": [
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/",
       "name": "System Design and Software Architecture 1",
       "position": 1
     },
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/topics/",
       "name": "Topics",
       "position": 2
     },
     {
       "@type": "ListItem",
       "name": "Kubernetes",
       "position": 3
     }
   ]
 }
</script>




  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-XF1V06CDS3"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-XF1V06CDS3');
        }
      </script>
    
  




</head>

  
  <body class="single section topics" data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0">
    <div class="sticky-top">
<header class="navbar navbar-expand-lg">
  <div class="container-lg">
  
    <a class="navbar-brand me-auto me-lg-3" href="/">System Design</a>

    
    
    <button type="button" id="searchToggleMobile" class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <circle cx="10" cy="10" r="7"></circle>
        <line x1="21" y1="21" x2="15" y2="15"></line>
      </svg>
    </button>
    
    
    <button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavMain" aria-controls="offcanvasNavMain" aria-label="Open main navigation menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <line x1="4" y1="8" x2="20" y2="8"></line>
        <line x1="4" y1="16" x2="20" y2="16"></line>
      </svg>
    </button>

    
    <div class="offcanvas offcanvas-end h-auto" tabindex="-1" id="offcanvasNavMain" aria-labelledby="offcanvasNavMainLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavMainLabel">System Design</h5>
        <button type="button" class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss="offcanvas" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M18 6l-12 12"></path>
            <path d="M6 6l12 12"></path>
         </svg>
        </button>
      </div>
      
      <div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between">
        <ul class="navbar-nav flex-grow-1"><li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/docs/guides/example-guide/">Docs</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/system-design/about">System Design</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/blog/">Blog</a>
              </li>
            </ul>

        
        
        <button type="button" id="searchToggleDesktop" class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <circle cx="10" cy="10" r="7"></circle>
            <line x1="21" y1="21" x2="15" y2="15"></line>
          </svg>
        </button>
        
        
        
        <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type="button" aria-label="Toggle theme">
          <svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
          </svg>
          <svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0m-5 0h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
          </svg>
        </button>
        
        <ul id="socialMenu" class="nav mx-auto flex-row order-lg-4">
          <li class="nav-item">
              <a class="nav-link social-link" href="https://github.com/valeryTech"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path></svg><small class="ms-2 visually-hidden">GitHub</small></a>
            </li>
          </ul>
        
        </div>
    </div>

    
    </div>
</header>
</div>

<div class="modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1>
        <button type="button" class="btn-close visually-hidden" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="search-input flex-grow-1 d-none">
          <form id="search-form" class="search-form" action="#" method="post" accept-charset="UTF-8" role="search">
            <label for="query" class="visually-hidden">Search</label>
            <div class="d-flex">
              <input type="search" id="query" name="query" class="search-text form-control form-control-lg" placeholder="Search" aria-label="Search" maxlength="128" autocomplete="off">
              <button type="button" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-body">
        <p class="search-loading status message d-none mt-3 text-center">Loading search index…</p>
        <p class="search-no-recent message d-none mt-3 text-center">No recent searches</p>
        <p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p>
        <div id="searchResults" class="search-results"></div>
        <template>
          <article class="search-result list-view">
            <div class="card my-3">
              <div class="card-body">
                <header>
                  <h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2>
                  <div class="submitted d-none"><time class="created-date">Date here</time></div>
                </header>
                <div class="content">Summary here</div>
              </div>
            </div>
          </article>
        </template>
      </div>
      <div class="modal-footer">
        <ul class="list-inline me-auto d-none d-md-block">
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li>
        </ul>
        <p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p>
      </div>
    </div>
  </div>
</div>


    <div class="wrap container-lg" role="document">
      <div class="content">
      
        
	<div class="row flex-xl-nowrap">
		
		<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="page-links">
  <h3>On this page</h3>
    <nav id="toc">
  <ul>
    <li><a href="#universalization">Universalization</a></li>
  </ul>

  <ul>
    <li><a href="#kube-exercises">kube exercises</a></li>
  </ul>
</nav>
</div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
			<h1>Kubernetes</h1>
			
			<nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation">
				<details>
    <summary>On this page</summary>
    <div class="page-links">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#universalization">Universalization</a></li>
  </ul>

  <ul>
    <li><a href="#kube-exercises">kube exercises</a></li>
  </ul>
</nav>
    </div>
  </details>

			</nav>
			<p>Architecture
Kubernetes architectures have many variations. For example, many
clusters run kube-apiserver, kube-scheduler, and kube-controller-
manager as containers. This means the control-plane may also run
a container-runtime, kubelet, and kube-proxy.</p>
<p>Rather than being concentrated in a single operations team that services other teams,
ops expertise will become distributed among many teams.
Each development team will need at least one ops specialist, responsible for the health
of the systems or services the team provides. They will be a developer as well, but they
will also be the domain expert on networking, Kubernetes, performance, resilience,
and the tools and systems that enable the other developers to deliver their code to the
cloud.</p>
<p>Developer Productivity Engineering
The point is that self-service has its limits, and the aim of DevOps is to speed up
development teams, not slow them down with unnecessary and redundant work.
Yes, a large part of traditional operations can and should be devolved to other teams,
primarily those that deploy code and respond to code-related incidents. But to enable
that to happen, there needs to be a strong central team building and supporting the
DevOps ecosystem in which all the other teams operate.
Instead of calling this team operations, we like the name developer productivity engi‐
neering. Some organizations call this role platform engineer or maybe even DevOps
engineer. The point is that these teams do whatever is necessary to help other software
engineering teams do their work better and faster: operating infrastructure, building
tools, busting problems.
And while developer productivity engineering remains a specialist skill set, the engi‐
neers themselves may move outward into the organization to bring that expertise
where it’s needed.</p>
<p>port forwarding
container registry</p>
<p>The <code>kubectl</code> tool is the primary way of interacting with a Kubernetes cluster.</p>
<p>The cluster’s brain is called the control plane, and it runs all the tasks required for
Kubernetes to do its job: scheduling containers, managing Services, serving API
requests, and so on</p>
<p>The control plane is actually made up of several components:</p>
<p>Node Components
Cluster members that run user workloads are called worker nodes.
Each worker node in a Kubernetes cluster runs these components: kubelet, kube-proxy, Container runtime</p>
<p>A rare, but entirely possible, kind of failure is losing a whole cloud availability zone.
Cloud vendors like AWS and Google Cloud provide multiple availability zones in
each region, each corresponding roughly to a single datacenter. For this reason, rather
than having all your worker nodes in the same zone, it’s a good idea to distribute
them across two or even three zones.</p>
<p>Trust, but verify
Although high availability should enable your cluster to survive losing some nodes,
it’s always wise to actually test this. During a scheduled maintenance window, or
outside of peak hours, try rebooting a worker and see what happens. (Hopefully,
nothing, or nothing that’s visible to users of your applications.) Then, if you can,
try rebooting a control plane node. See if you are able to continue running kubectl
commands while the node is down.</p>
<p>run less software and Undifferentiated heavy lifting</p>
<p>It’s probably fair to say that Fargate makes sense for simple, self-contained, long-
running compute tasks or batch jobs (such as data crunching) that don’t require
much customization or integration with other services. It’s also ideal for build con‐
tainers, which tend to be short-lived, and for any situation where the overhead of
managing worker nodes isn’t justified.</p>
<p>Maintaining Desired State
Kubernetes controllers continually check the desired state specified by each resource
against the actual state of the cluster, and make any necessary adjustments to keep
them in sync. This process is called the reconciliation loop, because it loops forever,
trying to reconcile the actual state with the desired state.</p>
<p>scheduler
https://jvns.ca/blog/2017/07/27/how-does-the-kubernetes-scheduler-work/</p>
<p>principle - declarativity
Because Kubernetes is inherently a declarative system, continuously reconciling actual
state with desired state, all you need to do is change the desired state—the Deploy‐
ment spec—and Kubernetes will do the rest. How do you do that?</p>
<p>resources are data</p>
<p>helm and artifact hub</p>
<p>managing resources</p>
<p>That’s where Kubernetes resource requests and limits come in. Kubernetes under‐
stands how to manage two kinds of resources: CPU and memory. There are other
important types of resources, too, such as network bandwidth, disk I/O operations
(IOPS), and disk space, and these may cause contention in the cluster, but Kubernetes
doesn’t yet have a way to describe Pods’ requirements for these.</p>
<p>overcommitting
Kubernetes allows resources to be overcommitted; that is, the sum of all the resource
limits of containers on a node can exceed the total resources of that node. This is a
kind of gamble: the scheduler is betting that, most of the time, most containers will
not need to hit their resource limits.
If this gamble fails, and total resource usage starts approaching the maximum
capacity of the node, Kubernetes will start being more aggressive in terminating
containers. Under conditions of resource pressure, containers that have exceeded
their requests, but not their limits, may still be terminated.</p>
<p>quality of service
Based on the requests and limits of a Pod, Kubernetes will classify it as one of the
following Quality of Service (QoS) classes: Guaranteed, Burstable, or BestEffort.</p>
<p>managing lifecycle</p>
<p>liveness probes
readiness probe
startup probe</p>
<p>practice?
This kind of readiness probe can be useful because if you want to take the container
temporarily out of service to debug a problem, you can attach to the container and
delete the /tmp/healthy file. The next readiness probe will fail, and Kubernetes will
remove the container from any matching Services. (A better way to do this, though,
is to adjust the container’s labels so that it no longer matches the service: see “Service
Resources” on page 61.)</p>
<p>Using Namespaces
Another very useful way of managing resource usage across your cluster is to use
namespaces. A Kubernetes namespace is a way of partitioning your cluster into
separate subdivisions, for whatever purpose you like.
For example, you might have different namespaces for testing out different versions
of an application, or a separate namespace per team. As the term namespace suggests,
names in one namespace are not visible from a different namespace.
This means that you could have a service called demo in the prod namespace, and a
different service called demo in the test namespace, and there won’t be any conflict.</p>
<h1 id="pods">Pods</h1>
<p>A Pod is a collection of application containers and volumes running in the same execution environment. Pods, not containers, are <em>the smallest deployable artifact</em> in a Kubernetes cluster. This means all of the containers in a Pod always land on the same machine.</p>
<p>Each container within a Pod runs in its own cgroup, but they share a number of Linux namespaces.</p>
<p>distribution of containers
At first, it might seem tempting to wrap both the web server and the Git synchronizer
into a single container. After closer inspection, however, the reasons for the separa‐
tion become clear. First, the two containers have significantly different requirements
in terms of resource usage. Take, for example, memory: because the web server is
serving user requests, we want to ensure that it is always available and responsive. On
the other hand, the Git synchronizer isn’t really user-facing and has a “best effort”
quality of service.</p>
<p>wordpress and mysql example
scaling factor
different scaling strategies
resources</p>
<blockquote>
<p>In general, the right question to ask yourself when designing Pods is “Will these containers work correctly if they land on different machines?”</p>
</blockquote>
<p>If the answer is no, a Pod is the correct grouping for the containers. If the answer is yes, using multiple Pods is probably the correct solution.</p>
<blockquote>
<p>Grouping multiple co-located and co-managed containers in a single Pod is a relatively advanced use case. You should use this pattern only in specific instances in which your containers are tightly coupled.</p>
</blockquote>
<p>Generally speaking, copying files into a container is an antipattern. You
really should treat the contents of a container as immutable.</p>
<h1 id="deployments">Deployments</h1>
<h1 id="replicaset">ReplicaSet</h1>
<p>When we define a ReplicaSet,
we define a specification for the Pods we want to create (the “cookie cutter”) and a
desired number of replicas. Additionally, we need to define a way of finding Pods that the ReplicaSet should control. The actual act of managing the replicated Pods is an
example of a reconciliation loop. Such loops are fundamental to most of the design
and implementation of Kubernetes.</p>
<p>Reconciliation Loops
The central concept behind a reconciliation loop is the notion of desired state versus
observed or current state.</p>
<h1 id="resource-management">Resource Management</h1>
<p>Resources are requested per container, not per Pod. The total
resources requested by the Pod is the sum of all resources reques‐
ted by all containers in the Pod because the different containers
often have very different CPU requirements.</p>
<p>Requests are used when scheduling Pods to nodes. The Kubernetes scheduler will
ensure that the sum of all requests of all Pods on a node does not exceed the capacity
of the node. Therefore, a Pod is guaranteed to have at least the requested resources
when running on the node. Importantly, “request” specifies a minimum. It does not
specify a maximum cap on the resources a Pod may use. To explore what this means,
let’s look at an example.</p>
<h1 id="service-discovery">Service Discovery</h1>
<p>While the dynamic nature of Kubernetes makes it easy to run a lot of things, it creates
problems when it comes to finding those things. Most of the traditional network
infrastructure wasn’t built for the level of dynamism that Kubernetes presents.</p>
<p><code>selector app=alpaca</code> ? how to use selector in services?</p>
<p>If we look at the SELECTOR column, we see that the alpaca-prod service simply gives
a name to a selector and specifies which ports to talk to for that service. The kubectl
expose command will conveniently pull both the label selector and the relevant ports
(8080, in this case) from the deployment definition.</p>
<p>Furthermore, that service is assigned a new type of virtual IP called a cluster IP. This
is a special IP address the system will load balance across all of the Pods that are
identified by the selector.</p>
<p>Kubernetes provides a DNS service exposed to Pods running in the cluster. This
Kubernetes DNS service was installed as a system component when the cluster was
first created. The DNS service is, itself, managed by Kubernetes and is a great example
of Kubernetes building on Kubernetes. The Kubernetes DNS service provides DNS
names for cluster IPs.</p>
<p>load balancers</p>
<p>The examples that we have seen so far use external load balancers; that is, load
balancers that are connected to the public internet. While this is great for exposing
services to the world, you’ll often want to expose your application within only your
private network. To achieve this, use an internal load balancer. Unfortunately, because
support for internal load balancers was added to Kubernetes more recently, it is
done in a somewhat ad hoc manner via object annotations.</p>
<h1 id="other">Other</h1>
<p>kubectl
aliases https://ahmet.im/blog/kubectl-aliases/index.html</p>
<p>jq and playground with it</p>
<p>generating resource manifests</p>



<div class="expressive-code">
  <figure class="frame is-terminal not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create deployment demo --image<span class="o">=</span>cloudnatived/demo:hello --dry-run<span class="o">=</span>client -o yaml &gt;deployment.yaml</span></span></code></pre></div>
  </figure>
</div>
<p>If you’ve been using imperative kubectl commands to manage your cluster up to
now, and you’d like to switch to the declarative style that we recommend in this book,
this is a great way to do it. Export all the resources in your cluster to manifest files
using kubectl with the -o flag, as shown in the example, and you’ll be all set.</p>
<p>diffing resources</p>
<p>contexts and namespaces
So what happens when you have more than one cluster? For example, maybe you
have a Kubernetes cluster on your machine for local testing and a production cluster
in the cloud, and perhaps another remote cluster for staging and development. How
does kubectl know which one you mean?
To solve this problem, kubectl has contexts. A context is a combination of a cluster, a
user, and a namespace</p>
<p>kubectx, kubens, krew, kube-ps1, kube-shell, Click,
kube-sh, Stern
your tools</p>
<p>But this
isn’t the best way to use containers, because then you don’t get the benefits of resource
isolation.
If processes don’t need to know about each other, then they don’t need to run in the
same container. A good rule of thumb with a container is that it should do one thing.</p>
<p>versioning practice
You should avoid using the latest tag when deploying containers in production as it
is harder to track which version of the image is running, and more difficult to roll back
properly.</p>
<p>init containers
https://www.baeldung.com/linux/kubernetes-init-containers</p>
<p>Labels
You know that Pods (and other Kubernetes resources) can have labels attached to
them, and that these play an important role in connecting related resources (for
example, sending requests from a Service to the appropriate backends).</p>
<p>Labels aren’t just used for connecting Services and Pods; you can use them directly
when querying the cluster with kubectl get, using the &ndash;selector flag:</p>
<p>DaemonSet
StatefulSet
Job
CronJob</p>
<p>HorizontalPodAutoscaler
The HPA uses another popular Kubernetes project called the Metrics Server for
getting the data it needs for making autoscaling decisions. You can install it following
the instructions in the metrics-server repo.</p>
<p>Although CPU utilization is the most common scaling metric, you can use any
metrics available to Kubernetes, including both the built-in system metrics like CPU
and memory usage, and app-specific service metrics, which you define and export
from your application (see Chapter 16). For example, you could scale based on the
application error rate or number of incoming requests per second.</p>
<p>Operators and Custom Resource Definitions (CRDs)</p>
<p>For example, if you wanted to create a controller object that sets up replicated,
high-availability MySQL database clusters in Kubernetes, how would you go about it?
The first step would be to create a CRD for your custom controller object. In order
to make it do anything, you then need to write a program that communicates with
the Kubernetes API. This is easy to do, as we saw in “Building Your Own Kubernetes
Tools” on page 132. Such a program is called an Operator (perhaps because it auto‐
mates the kinds of actions that a human operator might perform).
You can see lots of examples of Operators built and maintained by the community in
the OperatorHub.io site. This is a repository of hundreds of Operators that you can
install on your clusters, or just browse their code to get ideas for your building your
own Operators.</p>
<p>Ingress
While Services (see “Service Resources” on page 61) are for routing internal traffic
in your cluster (for example, from one microservice to another), Ingress is used for
routing external traffic into your cluster and to the appropriate microservice</p>
<p>Service Mesh
Kubernetes Ingress and Services may be all that you need for routing requests from
clients to your applications, depending on the complexity of your organization. But
there is also a growing interest in a newer concept commonly referred to as a service
mesh. A service mesh is responsible for managing more complex network operations
such as rate-limiting and encrypting network traffic between microservices. Service
mesh tools can also add metrics and logging for requests flowing through the net‐
work, keeping track of how long requests are taking, or tracing where a request
started and what path it took through the various microservices along the way. Some
service mesh tools can handle automatic retries of failed requests, and have the ability
to deny or block inbound or outbound requests as needed.</p>
<h2 id="universalization">Universalization<a href="#universalization" class="anchor" aria-hidden="true">#</a> </h2>
<p>one of the options (ways to think about &lsquo;universalization&rsquo;)</p>
<p>When we say “foundations,” what do we mean? The most important part to get
right is automation. Importantly, this includes both automation to deploy your
application(s), but also automation to create and manage the clusters themselves.
When you have a single cluster, it is consistent with itself by definition. However,
when you add clusters, you add the possibility of version skew between all of the
pieces of your cluster. You could have clusters with different Kubernetes versions,
different versions of your monitoring and logging agents, or even something as
basic as the container runtime. All of this variance should be viewed as something
that makes your life harder. Differences in your infrastructure make your system
“weirder.” Knowledge gained in one cluster does not transfer over to other clusters, and problems sometimes occur seemingly at random in certain places because of this
variability. One of the most important parts of maintaining a stable foundation is
maintaining consistency across all of your clusters.</p>
<h1 id="configuration">Configuration</h1>
<p>ConfigMaps
The ConfigMap is the primary object for storing configuration data in Kubernetes.
You can think of it as being a named set of key-value pairs that stores configuration
data. Once you have a ConfigMap, you can supply that data to an application either
by creating a file in the Pod, or by injecting it into the Pod’s environment.</p>
<p>phrases to sort and analyze
a file named kuard-pod.yaml and then using kubectl commands to <em>load that manifest</em> to Kubernetes.</p>
<h1 id="extending">extending</h1>
<p>When you’re ready to move beyond scripting calls to the kubectl executable, the
Kubernetes client libraries provide a way to dive deep into the API to build an
operator, a monitoring agent, a new user interface, or whatever your imagination can
dream up.</p>
<h1 id="resources">resources</h1>
<p>slack, forums, reddit?</p>
<h1 id="projects">projects</h1>
<p>and hands-on experience</p>
<h2 id="kube-exercises">kube exercises<a href="#kube-exercises" class="anchor" aria-hidden="true">#</a> </h2>
<p>https://github.com/eficode-academy/kubernetes-katas
https://github.com/eficode-academy/kubernetes-katas/blob/master/cheatsheet.md</p>
<p>https://github.com/eficode-academy/helm-katas</p>
<p>kubekloud</p>
<p>https://github.com/kubernetes/community</p>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				</div>
			<div class="page-nav d-flex flex-column flex-sm-row">
	
	<div class="card w-100">
			<div class="card-body d-flex">
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M5 12l6 6"></path>
						<path d="M5 12l6 -6"></path>
				 	</svg>
				</div>
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Prev</div>
					<a href="/topics/kafka/" class="stretched-link text-reset text-decoration-none">Kafka</a>
				</div>
			</div>
		</div>
	<div class="m-2"></div>
	<div class="card text-end w-100">
			<div class="card-body d-flex justify-content-end">
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Next</div>
					<a href="/topics/sql/" class="stretched-link text-reset text-decoration-none">Sql</a>
				</div>
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M13 18l6 -6"></path>
						<path d="M13 6l6 6"></path>
					</svg>
				</div>
			</div>
		</div>
	</div>

			
		</main>
		
	</div>

      
      </div>
    </div>
    
    
    <footer class="footer text-muted">
  <div class="container-lg">
    <div class="row">
      <div class="col-lg-8 text-center text-lg-start">
        <ul class="list-inline">
          <li class="list-inline-item"><a class="text-muted" href="/privacy/">Privacy Policy</a></li>
        </ul>
      </div>
      <div class="col-lg-8 text-center text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item">Brought to you by Valery</li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    

<script async
  src="/js/app.342099c10d1a06642e2779fba06362135a7d6a6cad5b489601040270bae5f10e.js"
  integrity="sha256-NCCZwQ0aBmQuJ3n7oGNiE1p9amytW0iWAQQCcLrl8Q4=">
</script>





<script async
  src="/js/flexsearch.be33aab3067e96554f261851c25a593228b91154cd28ff5c7f8d52b2e7f306d2.js"
  integrity="sha256-vjOqswZ&#43;llVPJhhRwlpZMii5EVTNKP9cf41SsufzBtI=">
</script>
<script async
  src="/js/search-modal.97d606e77f08deeb37876860d99c8f6813ef29263e73b6435c252de6be98d55e.js"
  integrity="sha256-l9YG538I3us3h2hg2ZyPaBPvKSY&#43;c7ZDXCUt5r6Y1V4=">
</script>

    
  </body>
</html>